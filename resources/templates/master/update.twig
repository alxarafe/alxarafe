{#
 ~ Alxarafe. Development of PHP applications in a flash!
 ~ Copyright (C) 2018-2019 Alxarafe <info@alxarafe.com>
#}
{% extends "index.twig" %}

{% block title %}{{ lang.trans('update') }} {{ lang.trans(ctrl.title) }}{% endblock %}

{% block extraStylesheets %}
    {{ parent() }}
    {#<link rel="stylesheet" type="text/css" href="{{ getResourceUri('/resources/common/css/common.css') }}">#}
{% endblock %}

{% block body %}
    {% import "master/autoforms.twig" as forms %}

    {% set encType = '' %}
    {% if ctrl.encType is not empty %}
        {% set encType = 'enctype="' ~ ctrl.encType ~ '"' %}
    {% endif %}
    {% set listFields = ctrl.getListFields() %}
    {% set pk =  ctrl.model.getOldData()[ctrl.model.getIdField()] %}
    <form action="{{ ctrl.url ~ '&' ~ constant('METHOD_CONTROLLER') ~ '=edit&' ~ ctrl.model.getIdField() ~ '=' ~ pk }}" method="post" accept-charset="utf-8" {{ encType }}>
        {% for regKey, registers in listFields %}
            {% for itemKey, item in registers %}
                <div class="row">
                    {{ forms.generateField(item, true, true, true) }}
                </div>
            {% endfor %}
        {% endfor %}

        <div class="row">
            <div class="col-md-12">&nbsp;</div>
        </div>
        <div class="row">
            <div class="col-xs-6">
                <a name="cancel" href="{{ ctrl.url }}" class="btn btn-danger btn-sm" type="submit" onClick="allowClose();" formnovalidate>
                    <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
                    {{ lang.trans('back') }}
                </a>
            </div>
            <div class="col-xs-6 text-right">
                <button name="action" value="save" class="btn btn-primary btn-sm" type="submit" onClick="allowClose();">
                    <span class="glyphicon glyphicon-save" aria-hidden="true"></span>
                    {{ lang.trans('save-changes') }}
                </button>
            </div>
        </div>
    </form>
{% endblock %}

{% block extraJavascriptsFooter %}
    {{ parent() }}
    <script type="text/javascript" src="{{ getResourceUri('/resources/common/js/common.js') }}"></script>
{% endblock %}